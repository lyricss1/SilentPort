<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <style>
        * { box-sizing: border-box; }
        body {
            background-color: #0d1117;
            color: #c9d1d9;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .navbar {
            background: #161b22;
            border-bottom: 1px solid #30363d;
            padding: 8px 15px;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-shrink: 0;
        }
        .nav-brand { font-weight: bold; color: #58a6ff; margin-right: auto; }
        .nav-btn {
            text-decoration: none;
            color: #c9d1d9;
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid #30363d;
            background: #21262d;
            font-size: 13px;
        }
        .nav-btn.active { background: #238636; color: white; border-color: #238636; }
        .logout-btn { background: #da3633; color: white; border: none; }

        .content {
            flex-grow: 1;
            padding: 10px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            gap: 10px;
        }

        .video-area {
            flex-shrink: 0;
            height: 40vh;
            background: #000;
            border: 1px solid #30363d;
            border-radius: 6px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }
        .screen-img { height: 100%; width: auto; max-width: 100%; object-fit: contain; }

        .cmd-form { display: flex; gap: 8px; flex-shrink: 0; }
        input[type="text"] {
            flex-grow: 1; padding: 10px; border-radius: 6px;
            border: 1px solid #30363d; background: #010409; color: #fff;
            font-family: 'Consolas', monospace; font-size: 16px; outline: none;
        }
        .run-btn {
            padding: 0 15px; background: #1f6feb; color: white;
            border: none; border-radius: 6px; cursor: pointer; font-weight: bold;
        }

        .terminal-window {
            flex-grow: 1; background: #010409; border: 1px solid #30363d;
            border-radius: 6px; display: flex; flex-direction: column;
            overflow: hidden; min-height: 100px;
        }
        .terminal-header {
            background: #161b22; padding: 5px 10px; font-size: 12px;
            color: #8b949e; border-bottom: 1px solid #30363d;
        }
        pre {
            margin: 0; padding: 10px; font-family: 'Consolas', monospace;
            font-size: 13px; color: #7ee787; overflow: auto;
            white-space: pre; height: 100%;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="nav-brand">ADMIN</div>
        <a href="{{ url_for('dashboard', mode='cmd') }}" class="nav-btn {{ 'active' if mode == 'cmd' else '' }}">CMD</a>
        <a href="{{ url_for('dashboard', mode='powershell') }}" class="nav-btn {{ 'active' if mode == 'powershell' else '' }}">PS</a>
        <a href="{{ url_for('dashboard', mode='screen') }}" class="nav-btn {{ 'active' if mode == 'screen' else '' }}">Screen</a>
        <a href="/logout" class="nav-btn logout-btn">Exit</a>
    </div>

    <div class="content">
        {% if mode == 'screen' %}
        <div class="video-area">
            <img src="{{ url_for('video_feed') }}" class="screen-img" alt="Live Stream">
        </div>
        {% endif %}

        <form method="POST" class="cmd-form">
            <input type="text" name="command"
                   placeholder="{% if mode == 'screen' %}CMD...{% else %}Command...{% endif %}"
                   value="{{ last_cmd }}" autocomplete="off" autofocus>
            <button type="submit" class="run-btn">RUN</button>
        </form>

        <div class="terminal-window">
            <div class="terminal-header">
                {% if mode == 'screen' %}
                    screen@mode (cmd active)
                {% else %}
                    {{ mode }}@server output
                {% endif %}
            </div>
            {% if output %}
                <pre>{{ output }}</pre>
            {% else %}
                <pre style="color: #8b949e;">Waiting...</pre>
            {% endif %}
        </div>
    </div>
</body>
</html>